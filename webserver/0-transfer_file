#!/usr/bin/env bash
# Transfers a file to a remote user's home directory via scp with host key checking disabled

if [ "$#" -lt 4 ]; then
  echo "Usage: 0-transfer_file PATH_TO_FILE IP USERNAME PATH_TO_SSH_KEY"
  exit 1
fi

FILE_PATH=$1
SERVER_IP=$2
SERVER_USER=$3
SSH_KEY=$4

if [ ! -f "$FILE_PATH" ]; then
  echo "Error: file '$FILE_PATH' does not exist." >&2
  exit 2
fi

# Perform transfer (to remote home directory ~/)
scp -i "$SSH_KEY" \
    -o StrictHostKeyChecking=no \
    -o UserKnownHostsFile=/dev/null \
    -- "$FILE_PATH" "$SERVER_USER@$SERVER_IP:~/"
